<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cross-validation model selection and species distribution
    mapping • SDMSelect</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Cross-validation model selection and species distribution
    mapping">
<meta property="og:description" content="Select GAM, GLM models using a multiple k-fold
    cross-validation and map species distribution while accounting for
    model uncertainties.  Multiple family are possible and compared all
    together using RMSE or AUC as a result of cross-validation procedure.
    Covariates correlation may be tested.  The model selection procedure
    will test different combinations of covariates with LM, GLM, GLM
    natural splines and GAM models, with different distributions
    (Gaussian, Gamma, Log-Normal, Tweedie; Binomial) and with different
    maximum degrees of freedom for GLM with polynoms or natural splines.
    Calculations are parallelized when possible.  Outputs are numerous,
    allowing for summary of the model selection and the comparison of the
    different models all together. The final model selected is used to map
    species distribution along with maps of uncertainty.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">SDMSelect</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Covar_Selection.html">Select the best covariates to fit a model</a>
    </li>
    <li>
      <a href="articles/SDM_Selection.html">Species distribution model selection</a>
    </li>
    <li>
      <a href="articles/TODO.html">To do list for dev</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/statnmap/SDMSelect/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div id="summary" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h1></div>
<p>The R package <strong>SDMSelect</strong> is for species distribution modeling (SDM). It uses a forward model selection with cross-validation to select covariates and model specifications that allow for best predictions. This selection is not specifically for SDM. Results can then be used for mapping predicted species distribution and uncertainty of prediction.</p>
<div class="figure" style="text-align: center">
<img src="https://raw.githubusercontent.com/statnmap/SDMSelect/master/img/ProbaOfPresence.png" alt="Distribution of probability of presence with SDMSelect library on Rstat" width="50%"><p class="caption">
Distribution of probability of presence with SDMSelect library on Rstat
</p>
</div>
</div>
<div id="how-to-cite" class="section level1">
<h1 class="hasAnchor">
<a href="#how-to-cite" class="anchor"></a>How to cite</h1>
<p>Please give credit where credit is due and cite R and R packages when you use them for data analysis. To cite <code>SDMSelect</code> properly, call the R built-in command <code><a href="https://rdrr.io/r/utils/citation.html">citation("SDMSelect")</a></code>:</p>
<blockquote>
<p>Sébastien Rochette. (2019, June 25). statnmap/SDMSelect: SDMSelect: A R-package for cross-validation model selection and species distribution mapping (Version v0.1.5). Zenodo. <a href="http://doi.org/10.5281/zenodo.3256536" class="uri">http://doi.org/10.5281/zenodo.3256536</a></p>
</blockquote>
</div>
<div id="download-and-install" class="section level1">
<h1 class="hasAnchor">
<a href="#download-and-install" class="anchor"></a>Download and Install</h1>
<p>Before installing <code>SDMSelect</code>, be sure to have updated versions of <code>mgcv (&gt;= 1.8-19)</code>, <code>dplyr (&gt;= 0.7)</code> and <code>corrplot (&gt;= 0.82)</code>.</p>
<p>To download the development version of the <code>SDMSelect</code> package, type the following at the R command line:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>  
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"statnmap/SDMSelect"</span><span class="op">)</span></code></pre></div>
<p>Build with vignettes:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"statnmap/SDMSelect"</span>, build_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"--no-resave-data"</span>, <span class="st">"--no-manual"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>To be able to test the vignettes, you will previously need to install <code>knitr</code>, <code>rmarkdown</code>, <code>dismo</code> and <code>rasterVis</code>. Vignette are available on {pkgdown} website for <a href="https://statnmap.github.io/SDMSelect/articles/Covar_Selection.html">covariates selection</a> and for <a href="https://statnmap.github.io/SDMSelect/articles/SDM_Selection.html">species distribution model selection</a></p>
<p>Note that spatial libraries like <code>rgdal</code> and <code>sp</code> may require additional softwares to be installed on your computer if you work with Mac or Linux. Look how to install <code>proj4</code>, <code>geos</code> and <code>gdal</code> on your system.</p>
<div id="issues" class="section level2">
<h2 class="hasAnchor">
<a href="#issues" class="anchor"></a>Issues</h2>
<ul>
<li>
<code>namespace 'mgcv' 1.xx is being loaded, but &gt;= 1.8.19 is required</code>. This means that you need to update <code>mgcv</code> library: <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("mgcv", force = TRUE)</a></code>.</li>
<li>Error when building vignette: <code>win.asp is not graphical parameter</code>. This means you did not install the last version of <code>corrplot</code>: <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("corrplot", force = TRUE)</a></code><br>
</li>
<li>
<code>there is no package called 'dismo' ... cannot create a RasterLayer object from this file (file does not exist)</code>: install library <code>dismo</code>: <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("dismo")</a></code>
</li>
</ul>
</div>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<p>Vignettes have been created to show how to use the library for covariate selection on simple cases (<code>vignette(package = "SDMSelect")</code>).</p>
<ul>
<li><p>First case is covariate selection procedure for classical dataset (not geographical data, nor species distribution data): <code><a href="articles/Covar_Selection.html">vignette("Covar_Selection", package = "SDMSelect")</a></code>. See the vignette in the {pkgdown} website: <a href="https://statnmap.github.io/SDMSelect/articles/Covar_Selection.html" class="uri">https://statnmap.github.io/SDMSelect/articles/Covar_Selection.html</a></p></li>
<li><p>The second case is for spatial data of species occurence to produce predicted species distribution maps and maps of uncertainties: <code><a href="articles/SDM_Selection.html">vignette("SDM_Selection", package = "SDMSelect")</a></code>. See the vignette in the {pkgdown} website: <a href="https://statnmap.github.io/SDMSelect/articles/SDM_Selection.html" class="uri">https://statnmap.github.io/SDMSelect/articles/SDM_Selection.html</a></p></li>
</ul>
<p><em>Note that most figures of the vignette are saved in “inst” so that model selection is not run during vignette building. However, code in the vignettes can be run on your own computer and should return the same outputs. You can also find the path of the complete vignettes to be run on your computer with: <code><a href="https://rdrr.io/r/base/system.file.html">system.file("Covar_Selection", "Covar_Selection.Rmd", package = "SDMSelect")</a></code> and <code><a href="https://rdrr.io/r/base/system.file.html">system.file("SDM_Selection", "SDM_Selection.Rmd", package = "SDMSelect")</a></code>. Open and click <code>knit</code> button if you are on Rstudio. (This may require 5-10 minutes depending on the number of cores of your system).</em><br>
Main functions are listed in the library general help: <code><a href="reference/SDMSelect.html">?SDMSelect</a></code>.</p>
</div>
<div id="description" class="section level1">
<h1 class="hasAnchor">
<a href="#description" class="anchor"></a>Description</h1>
<p>I decided to transform into a R package some R-scripts I have been using for years for my studies with species distribution modelling. I know it could be improved in many ways, but it works as is.<br>
This library has originally been created for covariates selection to predict species distribution (Biomass, density or presence/absence). Its final aim is thus to produce maps of predicted distributions (Look at vignette <code>SDM_Selection</code>). However, the core of the library is a N-times k-fold cross-validation selection procedure that can be applied to any kind of data, provided that model parameters are well defined (Look at vignette <code>Covar_selection</code>).</p>
<p>This works with <code>dataframe</code>, <code>SpatialPointsDataFrame</code> and <code>tibbles</code>.<br>
This has been designed to run in parallel in multiple cores computer, using library <code>parallel</code>. The only steps missing in this library are data exploration and data cleansing. These are important parts of modelling and should be realized prior to model selection procedure.</p>
<div id="selection-method" class="section level2">
<h2 class="hasAnchor">
<a href="#selection-method" class="anchor"></a>Selection method</h2>
<p>The model selection procedure will test different combinations of covariates with LM, GLM, GLM natural splines and GAM models, with different distributions (Gaussian, Gamma, Log-Normal, Tweedie; Binomial) and with different maximum degrees of freedom for GLM with polynoms or natural splines. The multiple k-fold cross-validation realised on the same folds for each model/submodel type allows their comparison using cross-validated RMSE or AUC. Covariates correlation can be tested prior to the selection procedure to avoid fitting models with correlated covariates. However, the cross-validation procedure is coupled with a forward stepwise procedure. This means that covariates are added to best models selected at the previous step. This obviously not choose a new covariate that add no predictive power to a model, thus avoiding selecting correlated covariates in the same model.<br>
Models are ordered according to RMSE (or AUC for presence-absence). The cross-validation produces a distribution of (<code>N*k</code>) RMSE values for each model at each step. Models are ordered according to mean RMSE. RMSE distributions of model <code>2</code> to <code>n</code> are then statistically compared to the best model. Models not statistically worse than the best model are retained for the next step. After the stepwise procedure, the best model among all is selected with the same method. Models not statistically worse are also retained.</p>
<div class="figure" style="text-align: center">
<img src="https://raw.githubusercontent.com/statnmap/SDMSelect/master/img/Help_for_model_Choice.png" alt="Models and covariates in models not statistically different from the best one. Covariates are ordered based on occurrence in the models selected." width="80%"><p class="caption">
Models and covariates in models not statistically different from the best one. Covariates are ordered based on occurrence in the models selected.
</p>
</div>
</div>
<div id="outputs" class="section level2">
<h2 class="hasAnchor">
<a href="#outputs" class="anchor"></a>Outputs</h2>
<p>Outputs of the selection procedure are numerous, allowing for summary of the model selection and the comparison of the different models alltogether (GAM, GLM; Gaussian, Gamma, Log-Normal, Tweedie; Binomial). All output files and figures are stored in a common folder and are not showing up in the R session directly. The final model retained by the user can then be analysed (residual analysis, variance analysis, effect of covariates). For spatial data, maps of prediction can be produced.</p>
</div>
<div id="uncertainties" class="section level2">
<h2 class="hasAnchor">
<a href="#uncertainties" class="anchor"></a>Uncertainties</h2>
<p>A particular attention has been given to assessment of uncertainty. Each prediction of a model is given with a standard error associated. This standard errors have been used to estimate possible minimum and maximum distributions of species (through estimations of quantiles).</p>
<div class="figure" style="text-align: center">
<img src="https://raw.githubusercontent.com/statnmap/SDMSelect/master/img/MinMaxProbaOfPresence.png" alt="Distribution of minimum (quantile 5%) and maximum (quantile 95%) of probabilities of presence with SDMSelect library on Rstat" width="80%"><p class="caption">
Distribution of minimum (quantile 5%) and maximum (quantile 95%) of probabilities of presence with SDMSelect library on Rstat
</p>
</div>
<p>Concerning presence-absence data, the estimation of probability of presence is not enough. The balance between presences and absences in data may conduct to biased predictions. The best threshold value to classify a probability of presence in presence or absence is here explored in more details. Map of probability to be over the threshold value is calculated.</p>
<div class="figure" style="text-align: center">
<img src="https://raw.githubusercontent.com/statnmap/SDMSelect/master/img/CompObsPred.png" alt="Comparison of predictions against observations in a presence-absence data model and thresholds values with SDMSelect library on Rstat" width="50%"><p class="caption">
Comparison of predictions against observations in a presence-absence data model and thresholds values with SDMSelect library on Rstat
</p>
</div>
<div class="figure" style="text-align: center">
<img src="https://raw.githubusercontent.com/statnmap/SDMSelect/master/img/ProbaOverThd.png" alt="Distribution of probabilities to be over the best threshold value separating presences from absences with SDMSelect library on Rstat" width="50%"><p class="caption">
Distribution of probabilities to be over the best threshold value separating presences from absences with SDMSelect library on Rstat
</p>
</div>
</div>
<div id="caution" class="section level2">
<h2 class="hasAnchor">
<a href="#caution" class="anchor"></a>Caution</h2>
<p>This library relies on a lot of other R-packages, which means that any modifications of those may prevent this library to work correctly. As I continue to use it regularly, I may see if some updates broke some of my functions and would try to fix them.<br>
There are recent libraries like <code>dplyr</code>, <code>tidyr</code>, <code>ggplot2</code> that did not originally exist when I first created these R-scripts. I now try to implement them from time to time.</p>
</div>
<div id="remark" class="section level2">
<h2 class="hasAnchor">
<a href="#remark" class="anchor"></a>Remark</h2>
<p>This library is not as complete as can be <code><a href="https://rdrr.io/r/base/library.html">library(caret)</a></code> in terms of model types available, however, as far as I know, <code>caret</code> model selection procedure is designed for a unique combination of model/distribution. Here, cross-validation outputs of each model/distribution are kept, and can then be compared all together with <em>paired</em> comparison. Not only the model with the best mean RMSE (or AUC) is retained, but also all other models giving predictions statistically as good as the best one. For biological purpose, knowing all models with the same predictive power may modify outputs interpretation. Another difference is that <code>SDMSelect</code> package is designed for predicting species distribution models, which means that some outputs are maps of species distributions as well as all maps of uncertainty that can be deduced from model outputs.</p>
</div>
</div>
<div id="collaboration" class="section level1">
<h1 class="hasAnchor">
<a href="#collaboration" class="anchor"></a>Collaboration</h1>
<p>For your work on covariates selection and species distribution modelling, you can contact me. Vignettes will give you a good starting point. I’ll be happy to participate to scientific collaborations based on this R-package. More information on my website <a href="https://statnmap.com" class="uri">https://statnmap.com</a>.</p>
<p>If you want to participate in improving this library, please have a look at my todo list (in Vignettes directory or in the <a href="https://statnmap.github.io/SDMSelect/articles/TODO.html">pkgdown site</a>) and feel free to clone, modify and provide pull requests. Please run the two Rmd files in <code>inst</code> folder before submitting a pull request. These are the complete versions of the two vignettes.</p>
<p>See full documentation realized using {pkgdown} at <a href="https://statnmap.github.io/SDMSelect/" class="uri">https://statnmap.github.io/SDMSelect/</a></p>
</div>
<div id="license" class="section level1">
<h1 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h1>
<p>This package is free and open source software, licensed under GPL.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/statnmap/SDMSelect/">https://​github.com/​statnmap/​SDMSelect/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/statnmap/SDMSelect/issues">https://​github.com/​statnmap/​SDMSelect/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3) | file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing SDMSelect</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Sébastien Rochette <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/statnmap/SDMSelect/actions"><img src="https://github.com/statnmap/SDMSelect/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://doi.org/10.5281/zenodo.3256536"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.3256536.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Sébastien Rochette.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
